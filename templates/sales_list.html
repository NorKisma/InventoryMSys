{% extends 'base.html' %} {% block content %}

<div class="card border-0">
  <div class="card-header">
    <h6 class="card-title">Sales Information</h6>

    <div class="d-flex justify-content-end">
      <input
        id="searchInput"
        type="text"
        class="form-control"
        placeholder="Search..."
      />

      <button
        type="button"
        class="btn btn-primary"
        onclick="window.location.href='{{ url_for('add_sale') }}'"
      >
        <i class="fa fa-plus-circle"></i> Add Sale
      </button>
    </div>
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-bordered" id="searchTable">
        <thead>
          <tr>
            <th>#</th>
            <th class="sortable">Customer</th>
            <th class="sortable">Product Name</th>
            <th class="sortable">Quantity</th>
            <th class="sortable">Price Sale</th>
            <th class="sortable">Subtotal</th>
            <th class="sortable">Discount</th>
            <th class="sortable">Payment</th>
            <th class="sortable">Balance</th>
            <th class="sortable">Paid Status</th>
            <th class="sortable">Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="salesTableBody">
          {% for data in row %}
          <tr>
            <td>{{ row[0] }}</td>
            <!-- Sale ID -->
            <td>{{ row[1] }}</td>
            <!-- Customer Name -->
            <td>{{ row[2] }}</td>
            <!-- Product Name -->
            <td>{{ row[3] }}</td>
            <!-- Quantity -->
            <td>{{ row[4] }}</td>
            <!-- Price Sale -->
            <td>{{ row[5] }}</td>
            <!-- Subtotal -->
            <td>{{ row[6] }}</td>
            <!-- Discount -->
            <td>{{ row[7] }}</td>
            <!-- Payment -->
            <td>{{ row[8] }}</td>
            <!-- Balance -->

            <!-- Paid Status with color coding -->
            <td
              style="{% if row[8] > 0 %} color: red; {% else %} color: green; {% endif %}"
            >
              {{ 'Unpaid' if row[8] > 0 else 'Paid' }}
            </td>

            <td>{{ row[9] }}</td>
            <!-- Sale Date -->

            <td>
              <!-- Edit Button -->
              <a
                href="{{ url_for('edit_sale', sale_id=row[0]) }}"
                class="btn btn-primary btn-sm"
              >
                <i class="fas fa-edit"></i>
              </a>

              <!-- Delete Button -->
              <form
                action="{{ url_for('delete_sale', sale_id=row[0]) }}"
                method="POST"
                style="display: inline"
              >
                <button
                  type="submit"
                  class="btn btn-danger btn-sm"
                  onclick="return confirm('Are you sure you want to delete this sale?');"
                >
                  <i class="fas fa-trash-alt"></i>
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/addmodels.js') }}"></script>

  {% endblock %}
</div>
