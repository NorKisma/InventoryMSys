{% extends 'base.html' %} {% block content %}

<div class="card border-0">
  <div class="card-header">
    <h6 class="card-title">Daily Sales Report</h6>

    <div class="d-flex justify-content-end">
      <!-- Date Range Picker -->
      <form
        method="get"
        action="{{ url_for('daily_sales_report') }}"
        class="d-flex"
      >
        <input
          id="startDate"
          name="start_date"
          type="date"
          class="form-control"
          placeholder="Start Date"
          value="{{ request.args.get('start_date', '') }}"
        />
        <input
          id="endDate"
          name="end_date"
          type="date"
          class="form-control ms-2"
          placeholder="End Date"
          value="{{ request.args.get('end_date', '') }}"
        />
        <button type="submit" class="btn btn-primary ms-2">
          Generate Report
        </button>
      </form>

      <!-- Add Sale Button -->
      <button
        type="button"
        class="btn btn-primary ms-2"
        onclick="window.location.href='{{ url_for('add_sale') }}'"
      >
        <i class="fa fa-plus-circle"></i> Add Sale
      </button>
    </div>
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <!-- Table -->
      <table class="table table-striped table-bordered" id="salesTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Customer</th>
            <th>Product Name</th>
            <th>Quantity</th>
            <th>Price Sale</th>
            <th>Subtotal</th>
            <th>Discount</th>
            <th>Payment</th>
            <th>Balance</th>
            <th>Status</th>
            <th>Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for sale in sales %}
          <tr>
            <td>{{ sale[0] }}</td>
            <td>{{ sale[1] }}</td>
            <td>{{ sale[2] }}</td>
            <td>{{ sale[3] }}</td>
            <td>{{ sale[4] }}</td>
            <td>{{ sale[5] }}</td>
            <td>{{ sale[6] }}</td>
            <td>{{ sale[7] }}</td>

            {% set balance = sale[8] | float %}
            <td
              style="
                {% if balance == 0 %}
                  color: green;
                  font-weight: bold;
                {% else %}
                  color: red;
                  font-style: italic;
                {% endif %}"
            >
              {% if balance == 0 %} Paid {% else %} Unpaid {% endif %}
            </td>

            <td>{{ sale[9] }}</td>
            <td>
              <a
                href="{{ url_for('edit_sale', sale_id=sale[0]) }}"
                class="btn btn-primary btn-sm"
              >
                <i class="fas fa-edit"></i>
              </a>
              <form
                action="{{ url_for('delete_sale', sale_id=sale[0]) }}"
                method="POST"
                style="display: inline"
              >
                <button
                  type="submit"
                  class="btn btn-danger btn-sm"
                  onclick="return confirm('Are you sure you want to delete this sale?');"
                >
                  <i class="fas fa-trash-alt"></i>
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/addmodels.js') }}"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Additional JavaScript if needed
    });
  </script>
  {% endblock %}
</div>
